import _0x29b843 from 'papaparse';
import * as _0x545163 from 'xlsx';

function parseCurriculum(_0x594ad0){let _0x544ab4='',_0x43a942='',_0x4519f7=0x0,_0x2ece04=null;const _0x1ad24d=[];return _0x29b843['parse'](_0x594ad0,{'skipEmptyLines':!![],'complete':_0x69fbc6=>{_0x69fbc6['data']['forEach'](_0x354fc2=>{const _0x2fa450=_0x354fc2['map'](_0x3aebac=>(_0x3aebac??'')['toString']()['trim']()),_0x798b7=_0x2fa450[0x0]??'';if(_0x798b7['includes']('Rev#')){const _0x13a259=_0x798b7['match'](/([A-Z0-9]+)\s*-\s*.*:\s*(.*?)\s+Rev#\s*(\d+)/i);_0x13a259&&(_0x544ab4=_0x13a259[0x1]?.['trim']()??'',_0x43a942=_0x13a259[0x2]?.['trim']()??'',_0x4519f7=parseInt(_0x13a259[0x3]??'0',0xa));return;}if(/FIRST YEAR/i['test'](_0x798b7)){_0x2ece04=0x1;return;}if(/SECOND YEAR/i['test'](_0x798b7)){_0x2ece04=0x2;return;}if(/THIRD YEAR/i['test'](_0x798b7)){_0x2ece04=0x3;return;}if(/FOURTH YEAR/i['test'](_0x798b7)){_0x2ece04=0x4;return;}if(/FIFTH YEAR/i['test'](_0x798b7)){_0x2ece04=0x5;return;}if(/First Semester/i['test'](_0x798b7)||/Second Semester/i['test'](_0x798b7)||/Summer/i['test'](_0x798b7))return;const _0x21ff45=[{'sem':0x1,'offset':0x0},{'sem':0x2,'offset':0x6},{'sem':0x3,'offset':0xc}];_0x21ff45['forEach'](({sem:_0x6ec09f,offset:_0x2cd2e9})=>{const _0x2723b4=_0x2fa450[_0x2cd2e9]??'',_0x4d85c7=_0x2fa450[_0x2cd2e9+0x1]??'',_0x3f4515=_0x2fa450[_0x2cd2e9+0x2]??'',_0x152f7b=_0x2fa450[_0x2cd2e9+0x3]??'',_0x152c95=_0x2fa450[_0x2cd2e9+0x4]??'';_0x2723b4&&_0x2ece04&&_0x1ad24d['push']({'curr_id':_0x544ab4,'program_name':_0x43a942,'revision_no':_0x4519f7,'year_level':_0x2ece04,'sem':_0x6ec09f,'course_id':_0x2723b4,'course_desc':_0x4d85c7,'total_units':_0x3f4515,'lec_unit':_0x152f7b,'lab_unit':_0x152c95});});});}}),_0x1ad24d;}

function convertToCSVFile(_0x200b1f){return new Promise((_0x1ada05,_0x56ae06)=>{const _0x3a9925=new FileReader();_0x3a9925['onload']=_0x6626d7=>{const _0x15d1e8=_0x6626d7['target']?.['result'];if(!_0x15d1e8){_0x56ae06(new Error('Failed\x20to\x20read\x20file'));return;}try{const _0x5794c8=_0x545163['read'](_0x15d1e8,{'type':'array'}),_0x4efb36=_0x5794c8['SheetNames'][0x0];if(!_0x4efb36){_0x56ae06(new Error('No\x20sheets\x20found\x20in\x20workbook'));return;}const _0x260ca2=_0x5794c8['Sheets'][_0x4efb36];if(!_0x260ca2){_0x56ae06(new Error('No\x20sheets\x20found\x20in\x20worksheet'));return;}const _0x89d19f=_0x545163['utils']['sheet_to_csv'](_0x260ca2),_0xf282e0=_0x200b1f['name']['replace'](/\.[^/.]+$/,'.csv'),_0x2c22aa=new File([_0x89d19f],_0xf282e0,{'type':'text/csv','lastModified':Date['now']()});_0x1ada05(_0x2c22aa);}catch(_0x1bd993){_0x56ae06(_0x1bd993);}},_0x3a9925['onerror']=()=>{_0x56ae06(new Error('File\x20reading\x20failed'));},_0x3a9925['readAsArrayBuffer'](_0x200b1f);});}

async function uploadCurriculum(_0x28b823,_0x13cd27){try{const _0x2865ac=await convertToCSVFile(_0x13cd27),_0x13b703=await _0x2865ac['text'](),_0x125847=parseCurriculum(_0x13b703),_0x1582ab=_0x29b843['unparse'](_0x125847),_0x5e6f0e=new File([_0x1582ab],_0x2865ac['name'],{'type':'text/csv'}),_0x37fa36=new FormData();_0x37fa36['append']('csvFile',_0x5e6f0e);const _0x2661a3=await fetch(_0x28b823+'/curr-courses/upload',{'method':'POST','body':_0x37fa36});if(!_0x2661a3['ok']){const _0xb510b8=await _0x2661a3['json']();throw _0xb510b8;}return _0x2661a3['json']();}catch(_0x2ebf2e){throw _0x2ebf2e;}}

class Client{['BASE_URL'];constructor(_0x53d04a){this['BASE_URL']=_0x53d04a;}['Parser'](){return {'curriculum':async _0x2798d1=>{const _0x2fcbcd=await uploadCurriculum(this['BASE_URL'],_0x2798d1);return _0x2fcbcd;}};}}

export { Client as default };
