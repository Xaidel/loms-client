import _0x551fd6 from 'papaparse';
import * as _0x457d22 from 'xlsx';

function parseCurriculum(_0x550c72){let _0x3bc0a8='',_0x4b76a9='',_0x4e8076=0x0,_0x3740c8=null;const _0x4b22fd=[];return _0x551fd6['parse'](_0x550c72,{'skipEmptyLines':!![],'complete':_0x2fa6ac=>{_0x2fa6ac['data']['forEach'](_0x50ef25=>{const _0x31e4bc=_0x50ef25['map'](_0x59e4df=>(_0x59e4df??'')['toString']()['trim']()),_0x280bb0=_0x31e4bc[0x0]??'';if(_0x280bb0['includes']('Rev#')){const _0x1a7d7d=_0x280bb0['match'](/([A-Z0-9]+)\s*-\s*.*:\s*(.*?)\s+Rev#\s*(\d+)/i);_0x1a7d7d&&(_0x3bc0a8=_0x1a7d7d[0x1]?.['trim']()??'',_0x4b76a9=_0x1a7d7d[0x2]?.['trim']()??'',_0x4e8076=parseInt(_0x1a7d7d[0x3]??'0',0xa));return;}if(/FIRST YEAR/i['test'](_0x280bb0)){_0x3740c8=0x1;return;}if(/SECOND YEAR/i['test'](_0x280bb0)){_0x3740c8=0x2;return;}if(/THIRD YEAR/i['test'](_0x280bb0)){_0x3740c8=0x3;return;}if(/FOURTH YEAR/i['test'](_0x280bb0)){_0x3740c8=0x4;return;}if(/FIFTH YEAR/i['test'](_0x280bb0)){_0x3740c8=0x5;return;}if(/First Semester/i['test'](_0x280bb0)||/Second Semester/i['test'](_0x280bb0)||/Summer/i['test'](_0x280bb0))return;const _0x13b277=[{'sem':0x1,'offset':0x0},{'sem':0x2,'offset':0x6},{'sem':0x3,'offset':0xc}];_0x13b277['forEach'](({sem:_0x17562c,offset:_0x4dbf94})=>{const _0x4a5982=_0x31e4bc[_0x4dbf94]??'',_0x41296c=_0x31e4bc[_0x4dbf94+0x1]??'',_0x2988a0=_0x31e4bc[_0x4dbf94+0x2]??'',_0x1ff2bb=_0x31e4bc[_0x4dbf94+0x3]??'',_0x1df29b=_0x31e4bc[_0x4dbf94+0x4]??'';_0x4a5982&&_0x3740c8&&_0x4b22fd['push']({'curr_id':_0x3bc0a8,'program_name':_0x4b76a9,'revision_no':_0x4e8076,'year_level':_0x3740c8,'sem':_0x17562c,'course_id':_0x4a5982,'course_desc':_0x41296c,'total_units':_0x2988a0,'lec_unit':_0x1ff2bb,'lab_unit':_0x1df29b});});});}}),_0x4b22fd;}

function convertToCSVFile(_0x31521a){return new Promise((_0x216950,_0x5aa7e2)=>{const _0x360b4c=new FileReader();_0x360b4c['onload']=_0x4dc0d9=>{const _0x5dd170=_0x4dc0d9['target']?.['result'];if(!_0x5dd170){_0x5aa7e2(new Error('Failed\x20to\x20read\x20file'));return;}try{const _0x496099=_0x457d22['read'](_0x5dd170,{'type':'array'}),_0x48e54e=_0x496099['SheetNames'][0x0];if(!_0x48e54e){_0x5aa7e2(new Error('No\x20sheets\x20found\x20in\x20workbook'));return;}const _0x127bc8=_0x496099['Sheets'][_0x48e54e];if(!_0x127bc8){_0x5aa7e2(new Error('No\x20sheets\x20found\x20in\x20worksheet'));return;}const _0x2c9aad=_0x457d22['utils']['sheet_to_csv'](_0x127bc8),_0x582977=_0x31521a['name']['replace'](/\.[^/.]+$/,'.csv'),_0x46c360=new File([_0x2c9aad],_0x582977,{'type':'text/csv','lastModified':Date['now']()});_0x216950(_0x46c360);}catch(_0x29c9bf){_0x5aa7e2(_0x29c9bf);}},_0x360b4c['onerror']=()=>{_0x5aa7e2(new Error('File\x20reading\x20failed'));},_0x360b4c['readAsArrayBuffer'](_0x31521a);});}

async function uploadCurriculum(_0x52a056,_0x2f9f92){try{const _0x4f16ee=await convertToCSVFile(_0x2f9f92),_0xde8223=await _0x4f16ee['text'](),_0x3750ad=parseCurriculum(_0xde8223),_0x5d6e17=_0x551fd6['unparse'](_0x3750ad),_0x50a0e0=new File([_0x5d6e17],_0x4f16ee['name'],{'type':'text/csv'}),_0x266063=new FormData();_0x266063['append']('csvFile',_0x50a0e0);const _0x321d3b=await fetch(_0x52a056+'/curr-courses/upload',{'method':'POST','body':_0x266063});if(!_0x321d3b['ok']){const _0x327b35=await _0x321d3b['json']();throw _0x327b35;}return _0x321d3b['json']();}catch(_0x50fa37){throw _0x50fa37;}}

class Client{['BASE_URL'];constructor(_0x3846a9){this['BASE_URL']=_0x3846a9;}['Parser'](){return {'curriculum':async _0x29d319=>{const _0x40cac4=await uploadCurriculum(this['BASE_URL'],_0x29d319);return _0x40cac4;}};}}

export { Client as default };
