import _0x2e956f from 'papaparse';
import * as _0x49bf28 from 'xlsx';

function parseCurriculum(_0x129dc7){let _0x431d37='',_0x240f46='',_0x5d14f4=0x0,_0x99212d=null;const _0x4d877c=[];return _0x2e956f['parse'](_0x129dc7,{'skipEmptyLines':!![],'complete':_0x4aeee8=>{_0x4aeee8['data']['forEach'](_0x17b4bc=>{const _0x294f96=_0x17b4bc['map'](_0x1f891d=>(_0x1f891d??'')['toString']()['trim']()),_0x2101b7=_0x294f96[0x0]??'';if(_0x2101b7['includes']('Rev#')){const _0x35f032=_0x2101b7['match'](/([A-Z]+)\s*-\s*.*:\s*(.*?)\s+Rev#\s*(\d+)/i);_0x35f032&&(_0x431d37=_0x35f032[0x1]?.['trim']()??'',_0x240f46=_0x35f032[0x2]?.['trim']()??'',_0x5d14f4=parseInt(_0x35f032[0x3]??'0',0xa));return;}if(/FIRST YEAR/i['test'](_0x2101b7)){_0x99212d=0x1;return;}if(/SECOND YEAR/i['test'](_0x2101b7)){_0x99212d=0x2;return;}if(/THIRD YEAR/i['test'](_0x2101b7)){_0x99212d=0x3;return;}if(/FOURTH YEAR/i['test'](_0x2101b7)){_0x99212d=0x4;return;}if(/FIFTH YEAR/i['test'](_0x2101b7)){_0x99212d=0x5;return;}if(/First Semester/i['test'](_0x2101b7)||/Second Semester/i['test'](_0x2101b7)||/Summer/i['test'](_0x2101b7))return;const _0x55c321=[{'sem':0x1,'offset':0x0},{'sem':0x2,'offset':0x6},{'sem':0x3,'offset':0xc}];_0x55c321['forEach'](({sem:_0x4cff2a,offset:_0x2bc337})=>{const _0xb881b8=_0x294f96[_0x2bc337]??'',_0x441ee2=_0x294f96[_0x2bc337+0x1]??'',_0x2b219a=_0x294f96[_0x2bc337+0x2]??'',_0x44a483=_0x294f96[_0x2bc337+0x3]??'',_0x1747b3=_0x294f96[_0x2bc337+0x4]??'';_0xb881b8&&_0x99212d&&_0x4d877c['push']({'curr_id':_0x431d37,'program_name':_0x240f46,'revision_no':_0x5d14f4,'year_level':_0x99212d,'sem':_0x4cff2a,'course_id':_0xb881b8,'course_desc':_0x441ee2,'total_units':_0x2b219a,'lec_unit':_0x44a483,'lab_unit':_0x1747b3});});});}}),_0x4d877c;}

function convertToCSVFile(_0x1f3f08){return new Promise((_0x2ec9ab,_0x4b2d94)=>{const _0x37dc9a=new FileReader();_0x37dc9a['onload']=_0x5de0c9=>{const _0x34ee96=_0x5de0c9['target']?.['result'];if(!_0x34ee96){_0x4b2d94(new Error('Failed\x20to\x20read\x20file'));return;}try{const _0x5654cb=_0x49bf28['read'](_0x34ee96,{'type':'array'}),_0x3c8ce4=_0x5654cb['SheetNames'][0x0];if(!_0x3c8ce4){_0x4b2d94(new Error('No\x20sheets\x20found\x20in\x20workbook'));return;}const _0x3c1af0=_0x5654cb['Sheets'][_0x3c8ce4];if(!_0x3c1af0){_0x4b2d94(new Error('No\x20sheets\x20found\x20in\x20worksheet'));return;}const _0x143830=_0x49bf28['utils']['sheet_to_csv'](_0x3c1af0),_0x5d50d4=_0x1f3f08['name']['replace'](/\.[^/.]+$/,'.csv'),_0x309906=new File([_0x143830],_0x5d50d4,{'type':'text/csv','lastModified':Date['now']()});_0x2ec9ab(_0x309906);}catch(_0x16d050){_0x4b2d94(_0x16d050);}},_0x37dc9a['onerror']=()=>{_0x4b2d94(new Error('File\x20reading\x20failed'));},_0x37dc9a['readAsArrayBuffer'](_0x1f3f08);});}

async function uploadCurriculum(_0x367c17,_0x5c3a7b){try{const _0x3e0f7d=await convertToCSVFile(_0x5c3a7b),_0x9858f3=await _0x3e0f7d['text'](),_0x48453d=parseCurriculum(_0x9858f3),_0x1fc178=_0x2e956f['unparse'](_0x48453d),_0x37e3ac=new File([_0x1fc178],_0x3e0f7d['name'],{'type':'text/csv'}),_0x4b9092=new FormData();_0x4b9092['append']('csvFile',_0x37e3ac);const _0x2b890c=await fetch(_0x367c17+'/curr-courses/upload',{'method':'POST','body':_0x4b9092});if(!_0x2b890c['ok']){const _0x181f09=await _0x2b890c['json']();throw _0x181f09;}return _0x2b890c['json']();}catch(_0x2ce404){throw _0x2ce404;}}

class Client{['BASE_URL'];constructor(_0x1e3b11){this['BASE_URL']=_0x1e3b11;}['Parser'](){return {'curriculum':async _0x2d8789=>{const _0x5560df=await uploadCurriculum(this['BASE_URL'],_0x2d8789);return _0x5560df;}};}}

export { Client as default };
